package management.repositories;

import applications.Application;
import java.util.Collections;
import java.util.Set;
import management.entities.vulnerabilities.VulnerabilityDB;
import org.junit.Assert;
import org.junit.jupiter.api.AfterAll;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;



@SpringBootTest(classes = Application.class)
class VulnerabilityRepositoryTest extends DbTestSimulator{

  @Autowired
  VulnerabilityRepository vulnerabilityRepository;

  @Test
  public void t() {
    VulnerabilityDB v = vulnerabilityRepository.save(new VulnerabilityDB("cve-123").setAliases(Set.of("a1", "a2")).setCvssScore(4.5f));
    VulnerabilityDB vdb = vulnerabilityRepository.findByCvssScoreGreaterThan(3.4f);

    Assertions.assertEquals(2, vdb.getAliases().size());
    Assertions.assertTrue(vdb.getAliases().contains("a1"));
    Assertions.assertEquals(1, vulnerabilityRepository.findAll().size());
  }

}